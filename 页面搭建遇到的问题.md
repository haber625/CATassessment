### 1: 布局问题

![image-20210423163901885](C:\Users\#\AppData\Roaming\Typora\typora-user-images\image-20210423163901885.png) 添加了float:left 去解决



### 2: onclick事件无法执行

```js
nav_a.onclick = function () {
  nav_a.style.backgroundColor = "#000";
}
```

+ 打印对象看是否能获取
+ 把function里改成'alert(1)'试一下,用来调试.
+ 若获取的是数组，要通过遍历去添加事件



### 3.js里改变属性

```js
names.style.display = none;(错，属性值需要加双引号)
nemas.style.display = "none";
```



### 4.用classname获取元素获取的是数组

```js
let btn = document.getElementsByClassName('btn');
//使用时以要写成btn[0];
btn[0].onclick = function(){}

//或者在获取的时候添加下标0
let btn = document.getElementsByClassName('btn')[0];
```



### 6.onclick调用函数

onclick调用函数时，如果没有参数，则不要加（）；否则函数无法执行



### 7.限制input里只能输入数字

```html
<input type="number" onkeyup="this.value=this.value.replace(/\D/g,'')">
```



### 8.去掉type="number"框内的上下箭头

```css
    /* 去掉type="number"的上下箭头 */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
    }
    input[type="number"]{
        -moz-appearance: textfield;
    }

```



### 10.setTimeout失败

```js
player.onmouseout = funtion(){
    setTimeout(function () { player.style.bottom = "-40px" }, 1000);
}
//鼠标没有已经执行setTimeout
```

  

### 11.调接口的status code

输入错误的密码和手机号时，status code = 501

stats code = 509 密码错误超出限制



### 12.保持登录

响应报文会传回来cookie和token，可以通过这两者判断登陆状态，也能通过这两者，刷新后保持登录

通过判断cookie的有无 和 token是否过期



#### 保持登录-token

前端接受token，将token写入localstroage中，后续的请求都带着token；

后台接收到token之后，会判断token是否过期，如果过期了，会向前端返回过期的标识或者状态码；

前端得到过期标识之后，需要清除localstroage里的token，<u>重新定向到login路由</u>



##### 将token存储在sessionstroage中

将token存储在sessionstroage中

注：sessionstroage只能存储字符串，需要利用JSON.stringify转换

```js
// 存：第一个参数为存在本地的名字，即本地容器的名字
sessionstroage.setItem('a',b)
// 取：只有一个参数，即本地储存容器的名字
sessionstroage.getItem('aa')
// 清除:只有一个参数，即本地储存容器的名字
sessionstroage.removeItem('aaa')
//清除所有
sessionstroage.clear()
```

检查token的有无：

```js
if (window.localStorage.getItem('token')){
    //如果token过期，会返回401，这时候需要重新跳回登陆界面
}
```



##### 将token储存在cookie中

```js
document.cookie = xhr.response.data.token;//网页关闭后token会被清除
```





### 13.二维码图片生成

#### 预定可选参数

在请求头里直接设置qrimg=1;



### 14.获取响应体的内容

需要将响应的结果通过JSON.parse转化为字符串型，才可以获取



### 15.通过判断改变和href内容失败

```js
this.style.href = "https://music.163.com/api/sns/authorize?snsType=10&clientType=web2&callbackType=Login&forcelogin=true";

//href不属于style里，去掉style
```



### 16.改变audio的src后，获取的duration是NAN

#### load();

解决方法：在更改了src之后，对audio进行更新

```js
audio.load()//更新
```

但是更新失败...

重新查资料后，给audio监听canplay时间,可以播放了之后再获取duration

```js
    audioPlayer.addEventListener("canplay", function () {
        audioPlayer.play();
		cur = audioPlay.duration();//可以播放后再获取时长
    })

```

#### video的canplay事件

当音频/视频处于加载过程中时，会依次发生以下事件：

loadstart
durationchange//这里指音频的时长数据发生了变化，但此时的duration是NAN
loadedmetadata
loadeddata
progress
canplay//在这里音频加载完了之后，获取的duration才是想要是时长
canplaythrough



### 17.切歌的时候滚动条不停地前后闪动

因为播放的时候添加了setInterval定时器，所以点击下一首、上一首的时候需要清除一下

```js
    clearInterval(timer1);
```

但是播放到最后一首歌曲的时候还是在前后闪动：

改：

原本把cleanIterval放在点击事情的开头，把cleanIterval移至setInterval前可以解决

### 18.轮播图开口结尾无缝转换？

在结尾再插入一个节点，和第一张图片一样

造成的问题：加了一个结点的同时小圆圈也多加了一个

办法：动态形成小圆圈放在添加最后一个节点的前面，这样就避免小圆圈数目的改变

问题：倒数第二张点击后到最后一张，但是还需要再点击一次到一样的第一张，最后一张图片如何自动跳转到第一张？（提交的时候还没想出来）



### 19.跨域问题

搭建的服务器时要加上xhrFields: { withCredentials: true }，服务器没有配置token字段时，需要配置一个字段

```node
'Access-Control-Allow-Headers':'X-Request-with,Content-Type,token,id'
```

（运行的时候要启动node app.js）



### 20.手动调用事件

```js
obj.click();//用来制作轮播图的自动切换
```



### 21.节流阀

```js
if(flag = true){
    flag = false;//相当于关闭回流阀
    function(){}//执行函数
    flag = true;//执行完函数之后再打开
}
//但是由于轮播图是直接更改ul的left值进行移动，所以没法采用节流阀
```

